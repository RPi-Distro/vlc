Index: vlc-1.1.3/modules/demux/playlist/xspf.c
===================================================================
--- vlc-1.1.3.orig/modules/demux/playlist/xspf.c	2011-06-08 21:37:30.000000000 +0000
+++ vlc-1.1.3/modules/demux/playlist/xspf.c	2011-06-08 21:38:05.000000000 +0000
@@ -504,7 +504,7 @@
                     }
                     free( psz_uri );
 
-                    if( p_sys->i_track_id < 0 )
+                    if( p_sys->i_track_id < 0 || p_sys->i_track_id >= (SIZE_MAX / sizeof(p_new_input)))
                     {
                         input_item_node_AppendNode( p_input_node, p_new_node );
                         vlc_gc_decref( p_new_input );
