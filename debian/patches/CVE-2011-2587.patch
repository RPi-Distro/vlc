From: RÃ©mi Denis-Courmont <remi@remlab.net>
Subject: [PATCH 1/2] real: fix heap buffer overflow (CVE-2011-2587)
Origin: upstream, http://git.videolan.org/?p=vlc/vlc-1.1.git;a=commit;h=3e7f0de57218f76a77f6b1759970e8740fd6ef0c

---
 modules/demux/real.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

--- a/modules/demux/real.c
+++ b/modules/demux/real.c
@@ -841,7 +841,8 @@
     demux_sys_t *p_sys = p_demux->p_sys;
     block_t *p_block = tk->p_sipr_packet;
 
-    if( p_sys->i_buffer < tk->i_frame_size )
+    if( p_sys->i_buffer < tk->i_frame_size
+     || tk->i_sipr_subpacket_count >= tk->i_subpacket_h )
         return;
 
     if( !p_block )
